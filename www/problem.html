<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>é¢˜ç›®è¯¦æƒ…</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="navbar">
        <a href="/" style="border:none; padding:0; font-size:1.2em;">â¬… è¿”å›é¢˜ç›®åˆ—è¡¨</a>
        <a href="#" id="editLink" style="background-color: #f39c12; color: white; border: none;">âœï¸ ç¼–è¾‘æ­¤é¢˜</a>
    </div>

    <div id="content" style="display:none;">
        <div class="detail-section">
            <h1 id="title" style="margin-top:0; border-bottom:1px solid #eee; padding-bottom:15px;">Loading...</h1>
            
            <div style="display:flex; gap:20px; margin-bottom:15px;">
                <div><strong>éš¾åº¦ï¼š</strong> <span id="difficulty"></span></div>
                <div><strong>ç®—æ³•ï¼š</strong> <span id="algo"></span></div>
                <div><strong>æ—¶é—´å¤æ‚åº¦ï¼š</strong> <span id="time"></span></div>
                <div><strong>ç©ºé—´å¤æ‚åº¦ï¼š</strong> <span id="space"></span></div>
            </div>
        </div>

        <div class="detail-section">
            <h2>ğŸ“– é¢˜ç›®æè¿°</h2>
            <p id="desc" style="white-space: pre-wrap;"></p>
        </div>
        
        <div class="detail-section">
            <h2>ğŸ’¡ è§£é¢˜æ€è·¯</h2>
            <p id="idea" style="white-space: pre-wrap;"></p>
        </div>
        
        <div class="detail-section">
            <h2>ğŸ’» ä»£ç å®ç°</h2>
            <pre id="code" class="code-block"></pre>
        </div>
    </div>
    
    <div id="errorMsg" style="text-align:center; color:red; display:none;"></div>

    <script>
        const difficultyMap = { 'Easy': 'ç®€å•', 'Medium': 'ä¸­ç­‰', 'Hard': 'å›°éš¾' };

        async function loadDetail() {
            const params = new URLSearchParams(window.location.search);
            const id = params.get('id');
            
            if (!id) {
                showError("æ— æ•ˆçš„é¢˜ç›®ID");
                return;
            }

            try {
                const response = await fetch(`/api/problems/${id}`);
                if (response.status === 404) {
                    showError("æœªæ‰¾åˆ°è¯¥é¢˜ç›® (404)");
                    return;
                }
                
                const p = await response.json();
                
                // å¡«å……æ•°æ®
                document.getElementById('title').innerText = p.title;
                document.getElementById('editLink').href = `/edit.html?id=${id}`;
                
                const diffText = difficultyMap[p.difficulty] || p.difficulty;
                const diffSpan = document.getElementById('difficulty');
                diffSpan.innerText = diffText;
                diffSpan.className = `difficulty-${p.difficulty}`;
                
                document.getElementById('algo').innerText = p.algorithm;
                document.getElementById('desc').innerText = p.description;
                document.getElementById('idea').innerText = p.solution_idea;
                document.getElementById('time').innerText = p.time_complexity;
                document.getElementById('space').innerText = p.space_complexity;
                document.getElementById('code').innerText = p.code;

                // æ˜¾ç¤ºå†…å®¹
                document.getElementById('content').style.display = 'block';
            } catch (err) {
                showError("åŠ è½½å¤±è´¥: " + err.message);
            }
        }

        function showError(msg) {
            const el = document.getElementById('errorMsg');
            el.innerText = msg;
            el.style.display = 'block';
        }

        loadDetail();
    </script>
</body>
</html>